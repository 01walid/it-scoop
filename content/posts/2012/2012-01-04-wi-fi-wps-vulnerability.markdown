---
author: Xacker
date: 2012-01-04 18:01:51+00:00
draft: false
title: اكتشاف ثغرة في بروتوكول WPS تسهل من مهمة تجاوز حماية أجهزة Wireless router
type: post
url: /2012/01/wi-fi-wps-vulnerability/
categories:
- Security
- برمجيات
tags:
- Stefan Viehböck
- Wi-FI
- Wireless router
- WPS
---

هل تملك Wireless router؟ إذا كانت إجابتك نعم فعليك اتخاذ قرار بشأن ترك خيار  Wi-Fi Protected Setup المعروف اختصارا بـ WPS مفعّلا بشكل افتراضي، كما هو الحال في منتجات كبرى الشركات.




[![اكتشاف ثغرة في بروتوكوا WPS تقلل من أمان شبكات Wifi](http://www.it-scoop.com/wp-content/uploads/2012/01/wifi-vulnerability.jpg)
](http://www.it-scoop.com/wp-content/uploads/2012/01/wifi-vulnerability.jpg)




**ما هو WPS، بأي حال؟** WPS هو عبارة عن وسيلة تم تطويرها وتقديمها من قبل اتحاد Wi-Fi لمساعدة المستخدمين على إعداد اتصالاتهم اللاسلكية بأجهزتهم. بدون WPS، سيجد المستخدم نفسه مضطراً لاتخاذ عدة خيارات قبل أن يتمكن من توصيل حاسوبه المحمول بالـ router الخاص به، مثل خوارزمية التشفير،وطول الكلمة السرية وصيغتها... الأمر الذي يعني أنه يجب أن يكون لدى المستخدم خلفية لا بأس بها حول هذه النواحي قبل أن يتمكن من استثمار جهاز Router بشكل لاسلكي.




أما مع WPS، فكل ما على المستخدم القيام به هو الضغط على زر Wi-Fi Protected Setup في حال توفره أو إدخال PIN (بطول 8 أرقام) خاص بالجهاز والبدء بالاتصال مباشرة.




[![](http://www.it-scoop.com/wp-content/uploads/2012/01/wps-300x273.jpg)
](http://www.it-scoop.com/wp-content/uploads/2012/01/wps.jpg)




**إذاً لم كل هذه الجلبة؟**




للأسف (هل أنا حزين حقاً؟ :D)، فقد قام Stefan Viehböck بالتبليغ عن خطأ في تصميم WPS يؤدي إلى تخفيض الزمن اللازم لهجوم brute-force بغية كشف PIN، حيث يتمكن المهاجم من معرفة ما إذا كان النصف الأول من الأرقام الثمانية صحيحاً. وبفضل غياب سياسة منع مؤقت بعد عدد معين من المحاولات الخاطئة، في عدد لا بأس به من أجهزة الـ routers التابعة لإحدى كبار الشركات المصنعه، فإن الهجوم يصبح وارداً بشكل أكبر.




عندما تفشل عملية المصادقة على الـ PIN (لأن القيمة خاطئة) فإن الـ router سيقوم بإرسال رد EAP-NACK إلى جهاز الزبون. الطريقة التي ترسل بها رسائل EAP-NACK تمكن المهاجم من معرفة فيما إذا كان النصف الأول من الرقم الذي يقوم بتجربته صحيحاً. بالإضافة إلى هذا، فإن القيمة الأخيرة من الرقم معروفة لكونها checksum للـ  PIN ويمكن حسابها بمجرد معرفتك للـ 7 قيم الأولى. هذا يعني أن عدد المحاولات اللازمة لاكتشاف PIN واحد ينخفض من 108 إلى مجموع 104 (النصف الأول من الرقم) + 103(النصف الثاني بدون قيمة الـ checksum) ما يشكل بالمجمل 11,000 محاولة فقط.




من الشركات التي تم التأكد من إصابة أجهزتها بهذا الخلل: D-Link, Linksys, Netgear, TP-Link, ZyXEL, Belkin, Buffalo, Technicolor.




**إجراء وقائي:**




تعطيل خيار Wi-Fi Protected Setup (WPS) الذي قد يكون باسم “external registrar”  أو Router PIN، وذلك تبعاً للشركة المصنّعة.
